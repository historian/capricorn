{target_dir, "capricorn"}.

{overlay, [
  {mkdir, "var/run/capricorn-machine"},
  {mkdir, "var/run/capricorn-cluster"},
  {mkdir, "var/log/sasl"},
  {copy, "overlay/bin/capricornd",        "bin/capricornd"},
  {copy, "overlay/erts-vsn/bin/erl",      "{{erts_vsn}}/bin/erl"},
  {copy, "overlay/erts-vsn/bin/nodetool", "{{erts_vsn}}/bin/nodetool"},
  {copy, "overlay/etc/capricorn/app.config", "etc/capricorn/app.config"},
  {copy, "overlay/etc/capricorn/cluster-vm.args", "etc/capricorn/cluster-vm.args"},
  {copy, "overlay/etc/capricorn/machine-vm.args", "etc/capricorn/machine-vm.args"}
]}.

{sys, [
  {lib_dirs, ["../lib", "../deps"]},
  {rel, "capricorn", "1.0.0", [
    kernel,
    stdlib,
    sasl,
    inets,
    crypto,
    ssl,
    ep2p,
    
    bert,
    bertio,
    bertrpc,
    emq,
    mochiweb,
    capricorn,

    reltool,
    compiler
  ]},
  {rel, "start_clean", "", [
    kernel,
    stdlib,
    ep2p,
    ssl
  ]},
  {boot_rel, "capricorn"},
  {profile, embedded},
  {app, bert,      [{incl_cond, include}]},
  {app, bertio,    [{incl_cond, include}]},
  {app, bertrpc,   [{incl_cond, include}]},
  {app, emq,       [{incl_cond, include}]},
  {app, mochiweb,  [{incl_cond, include}]},
  {app, capricorn, [{incl_cond, include}]},
  {app, sasl,      [{incl_cond, include}]},
  {app, crypto,    [{incl_cond, include}]},
  {app, ssl,       [{incl_cond, include}]},
  {app, ep2p,      [{incl_cond, include}]},
  {app, reltool,   [{incl_cond, include}]},
  {app, compiler,  [{incl_cond, include}]}
]}.
